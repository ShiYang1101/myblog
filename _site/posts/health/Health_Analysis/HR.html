<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Most interesting blog on Earth! – hr</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Most interesting blog on Earth!</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html">
 <span class="menu-text">Aetius Lee</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ShiYang1101"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/shi-yang-lee"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">



<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.signal <span class="im">as</span> signal</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.dates <span class="im">import</span> date2num</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-defined madules for dataframes cleaning</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> fitbit_dataprep <span class="im">as</span> fit</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> garmin</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="the-first-thing-to-investigate-is-to-determine-the-correlation-between-fitbit-and-garmins-heart-rate-collection-throughou-the-day.-i-have-choosen-a-random-day-as-a-starting-point." class="level2">
<h2 class="anchored" data-anchor-id="the-first-thing-to-investigate-is-to-determine-the-correlation-between-fitbit-and-garmins-heart-rate-collection-throughou-the-day.-i-have-choosen-a-random-day-as-a-starting-point.">The first thing to investigate is to determine the correlation between Fitbit and Garmin’s heart rate collection throughou the day. I have choosen a random day as a starting point.</h2>
</section>
<section id="fitbit-data-preperation" class="level2">
<h2 class="anchored" data-anchor-id="fitbit-data-preperation">Fitbit data preperation</h2>
<div class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Fitbit_dir <span class="op">=</span> <span class="st">"./Fitbit/ShiYangLee/Physical Activity/heart_rate-2022-03-29.json"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="198">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing fitbit's heart rate data on day of interest</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df_fitbit <span class="op">=</span> pd.read_json(Fitbit_dir)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df_fitbit.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="198">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>dateTime</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022-03-28 23:00:06</td>
      <td>{'bpm': 56, 'confidence': 3}</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2022-03-28 23:00:21</td>
      <td>{'bpm': 56, 'confidence': 3}</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2022-03-28 23:00:31</td>
      <td>{'bpm': 57, 'confidence': 3}</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2022-03-28 23:00:41</td>
      <td>{'bpm': 58, 'confidence': 3}</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2022-03-28 23:00:46</td>
      <td>{'bpm': 57, 'confidence': 3}</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>The confidence value provided by Fitbit is rather unhelpful. As Fitbit officials only stated that confidence indicated the percentages of the measured heart rate matches with true heart rate value, with 1 the lowerst and 3 the highest. However, the precise definition of what the condifence value represented was nowhere to be found.</p>
<div class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df_fitbit.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="130">
<pre><code>dateTime    0
value       0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="201">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Since raw fitbit data is not in the desired form, we need to write a function </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># to split the data.</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>fit.data_split(df_fitbit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The dataframe is already splitted!</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="201">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>dateTime</th>
      <th>bpm</th>
      <th>confidence</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022-03-28 23:00:06</td>
      <td>56</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2022-03-28 23:00:21</td>
      <td>56</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2022-03-28 23:00:31</td>
      <td>57</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2022-03-28 23:00:41</td>
      <td>58</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2022-03-28 23:00:46</td>
      <td>57</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11351</th>
      <td>2022-03-29 22:59:38</td>
      <td>75</td>
      <td>3</td>
    </tr>
    <tr>
      <th>11352</th>
      <td>2022-03-29 22:59:43</td>
      <td>79</td>
      <td>2</td>
    </tr>
    <tr>
      <th>11353</th>
      <td>2022-03-29 22:59:48</td>
      <td>73</td>
      <td>2</td>
    </tr>
    <tr>
      <th>11354</th>
      <td>2022-03-29 22:59:53</td>
      <td>68</td>
      <td>3</td>
    </tr>
    <tr>
      <th>11355</th>
      <td>2022-03-29 22:59:58</td>
      <td>64</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>11356 rows × 3 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="203">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The data also require further cleaning</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>df_fitbit <span class="op">=</span> fit.fitbit_dataprep(df_fitbit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The dataframe was already prepared!</code></pre>
</div>
</div>
<div class="cell" data-execution_count="204">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_fitbit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     bpm  confidence
dateTime                            
2022-03-28 23:00:06   56           3
2022-03-28 23:00:21   56           3
2022-03-28 23:00:31   57           3
2022-03-28 23:00:41   58           3
2022-03-28 23:00:46   57           3
...                  ...         ...
2022-03-29 22:59:38   75           3
2022-03-29 22:59:43   79           2
2022-03-29 22:59:48   73           2
2022-03-29 22:59:53   68           3
2022-03-29 22:59:58   64           3

[11356 rows x 2 columns]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="138">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shifting data to account for british summer time change</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (Do your own job, Fitbit!)</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>df_fitbit.index <span class="op">=</span> df_fitbit.index.shift(<span class="dv">1</span>, freq<span class="op">=</span><span class="st">'H'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As the aim of the notebook is to compare Fitbit towards Garmin’s data, which the heart rate data is by the minutes, we are going to trim Fitbit’s data down and to match Garmin’s dateTime.</p>
<div class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing dummy indeces.</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> pd.date_range(<span class="st">'2022-03-29 00:00'</span>, <span class="st">'2022-3-30 00:00'</span>, freq <span class="op">=</span> <span class="st">'T'</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tmp)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(tmp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DatetimeIndex(['2022-03-29 00:00:00', '2022-03-29 00:01:00',
               '2022-03-29 00:02:00', '2022-03-29 00:03:00',
               '2022-03-29 00:04:00', '2022-03-29 00:05:00',
               '2022-03-29 00:06:00', '2022-03-29 00:07:00',
               '2022-03-29 00:08:00', '2022-03-29 00:09:00',
               ...
               '2022-03-29 23:51:00', '2022-03-29 23:52:00',
               '2022-03-29 23:53:00', '2022-03-29 23:54:00',
               '2022-03-29 23:55:00', '2022-03-29 23:56:00',
               '2022-03-29 23:57:00', '2022-03-29 23:58:00',
               '2022-03-29 23:59:00', '2022-03-30 00:00:00'],
              dtype='datetime64[ns]', length=1441, freq='T')
1441</code></pre>
</div>
</div>
<div class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get nearest datapoint in Fitbit df to the dummy indices.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>loc <span class="op">=</span> [df_fitbit.index.get_loc(x, <span class="st">"nearest"</span>) <span class="cf">for</span> x <span class="kw">in</span> tmp]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Trim Fitbit df to the required rows.</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>df_fitbit <span class="op">=</span> df_fitbit.iloc[loc]</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting the indices to correct time.</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>df_fitbit.index <span class="op">=</span> df_fitbit.index.<span class="bu">round</span>(freq <span class="op">=</span> <span class="st">"T"</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>df_fitbit.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="140">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>bpm</th>
      <th>confidence</th>
    </tr>
    <tr>
      <th>dateTime</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022-03-29 00:00:00</th>
      <td>56</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2022-03-29 00:01:00</th>
      <td>58</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2022-03-29 00:02:00</th>
      <td>56</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2022-03-29 00:03:00</th>
      <td>56</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2022-03-29 00:04:00</th>
      <td>55</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Now that the Fitbit data looks good, it’s time to shift focus to Garmin data.</p>
</section>
<section id="garmin-data-preperation." class="level2">
<h2 class="anchored" data-anchor-id="garmin-data-preperation.">Garmin data preperation.</h2>
<p>The garmin data was acquired through scripts named GarminDB, which utilized the API for Garmin Connect. The API convert unreadable raw FIT files to healthier databases. Let’s look at what databases there are.</p>
<div class="cell" data-execution_count="141">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>ls .<span class="op">/</span>HealthData<span class="op">/</span>DBs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>fitbit.db         garmin.db         garmin_summary.db  summary.db
garmin_activities.db  garmin_monitoring.db  mshealth.db</code></pre>
</div>
</div>
<div class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exploring what are contained in the garmin.db.</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>garmin_db <span class="op">=</span> <span class="st">"./HealthData/DBs/garmin.db"</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(garmin_db)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>cur <span class="op">=</span> con.cursor()</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT name FROM sqlite_master WHERE type='table'"</span>, con)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>_attributes</td>
    </tr>
    <tr>
      <th>1</th>
      <td>attributes</td>
    </tr>
    <tr>
      <th>2</th>
      <td>devices</td>
    </tr>
    <tr>
      <th>3</th>
      <td>weight</td>
    </tr>
    <tr>
      <th>4</th>
      <td>stress</td>
    </tr>
    <tr>
      <th>5</th>
      <td>sleep</td>
    </tr>
    <tr>
      <th>6</th>
      <td>sleep_events</td>
    </tr>
    <tr>
      <th>7</th>
      <td>resting_hr</td>
    </tr>
    <tr>
      <th>8</th>
      <td>daily_summary</td>
    </tr>
    <tr>
      <th>9</th>
      <td>files</td>
    </tr>
    <tr>
      <th>10</th>
      <td>device_info</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="143">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>garmin_df <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * FROM sleep"</span>, con)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>garmin_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="143">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>day</th>
      <th>start</th>
      <th>end</th>
      <th>total_sleep</th>
      <th>deep_sleep</th>
      <th>light_sleep</th>
      <th>rem_sleep</th>
      <th>awake</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-08-23</td>
      <td>None</td>
      <td>None</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-10-02</td>
      <td>None</td>
      <td>None</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-11-08</td>
      <td>None</td>
      <td>None</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-01-31</td>
      <td>None</td>
      <td>None</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-03-15</td>
      <td>None</td>
      <td>None</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
      <td>00:00:00.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Not what we are workign for. Further digging reveals that full raw data are located in “monitoring” databases.</p>
<div class="cell" data-execution_count="144">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>garmin_monit_db <span class="op">=</span> <span class="st">"./HealthData/DBs/garmin_monitoring.db"</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>garmin_monit_con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(garmin_monit_db)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(<span class="st">"SELECT name FROM sqlite_master WHERE type='table'"</span>, garmin_monit_con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="144">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>_attributes</td>
    </tr>
    <tr>
      <th>1</th>
      <td>monitoring_info</td>
    </tr>
    <tr>
      <th>2</th>
      <td>monitoring_hr</td>
    </tr>
    <tr>
      <th>3</th>
      <td>monitoring_intensity</td>
    </tr>
    <tr>
      <th>4</th>
      <td>monitoring_climb</td>
    </tr>
    <tr>
      <th>5</th>
      <td>monitoring</td>
    </tr>
    <tr>
      <th>6</th>
      <td>monitoring_rr</td>
    </tr>
    <tr>
      <th>7</th>
      <td>monitoring_pulse_ox</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="145">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>garmin_hr <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * FROM monitoring_hr"</span>, garmin_monit_con)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>garmin_hr.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="145">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>heart_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>40649.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>73.473837</td>
    </tr>
    <tr>
      <th>std</th>
      <td>17.282922</td>
    </tr>
    <tr>
      <th>min</th>
      <td>44.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>59.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>73.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>84.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>176.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="146">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only select the particular day of March 29 2022.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>garmin_0329_hr <span class="op">=</span> garmin_hr.loc[(garmin_hr[<span class="st">'timestamp'</span>] <span class="op">&gt;=</span> <span class="st">'2022-03-29'</span>) <span class="op">&amp;</span> <span class="op">\</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                               (garmin_hr[<span class="st">'timestamp'</span>] <span class="op">&lt;</span> <span class="st">'2022-03-30'</span>)]</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(garmin_0329_hr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        timestamp  heart_rate
2327   2022-03-29 09:29:00.000000         117
2328   2022-03-29 09:30:00.000000         123
2329   2022-03-29 09:31:00.000000         110
2330   2022-03-29 09:32:00.000000          97
2331   2022-03-29 09:33:00.000000          92
...                           ...         ...
13375  2022-03-29 23:56:00.000000          55
13376  2022-03-29 23:57:00.000000          56
13377  2022-03-29 23:58:00.000000          57
13378  2022-03-29 23:59:00.000000          56
13379  2022-03-29 23:59:59.000000          58

[1036 rows x 2 columns]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defines function for data preperation for Garmin data.</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># For filling null values of heart rate data, we have chosed the method </span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># of taking the average of values before and after the null windows.</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> average_fill(data):</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Function defined for filling null values in a time series panda series.</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">    The method is by adding forward filling and backward filling in to </span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co">    the original data, and taking averages, dividing by 2.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Any null window will be filled by the average of values before and after</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co">    the window.</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data.ffill().fillna(method <span class="op">=</span> <span class="st">'bfill'</span>).<span class="op">\</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>                    add(data.bfill().fillna(method <span class="op">=</span> <span class="st">'ffill'</span>)).div(<span class="dv">2</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> garmin_prep(data, start <span class="op">=</span> <span class="va">None</span>, end <span class="op">=</span> <span class="va">None</span>, reindex <span class="op">=</span> <span class="st">'T'</span>, <span class="op">\</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>               data_type <span class="op">=</span> <span class="st">'monit'</span>):</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="co">    Function for garmin data preperation, setting timetamp as indices,</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co">    converting datetime to format from years to seconds. Also fill null</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co">    values with average filling method.</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data.index.dtype <span class="op">==</span> pd.api.types.is_datetime64_any_dtype:</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"The datafarme had already been prepared!"</span>)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start <span class="op">!=</span> <span class="va">None</span> <span class="kw">and</span> end <span class="op">!=</span> <span class="va">None</span>:</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> data.loc[(data[<span class="st">'timestamp'</span>] <span class="op">&gt;=</span> start) <span class="op">&amp;</span> (data[<span class="st">'timestamp'</span>] <span class="op">&lt;</span> end)]</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>    data_tmp <span class="op">=</span> data.set_index(<span class="st">'timestamp'</span>)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>    data_tmp.index <span class="op">=</span> pd.to_datetime(data_tmp.index, <span class="bu">format</span><span class="op">=</span><span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S"</span>)</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> reindex <span class="op">!=</span> <span class="va">False</span>:</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>        data_tmp <span class="op">=</span> data_tmp.reindex(pd.date_range(start, end, freq <span class="op">=</span> reindex))</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data_type <span class="op">==</span> <span class="st">'monit'</span>:</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>        data_tmp <span class="op">=</span> average_fill(data_tmp)</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span> data_tmp.isnull().<span class="bu">sum</span>().values <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> data_type <span class="op">==</span> <span class="st">'act_monit'</span>:</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>        data_tmp[<span class="st">'hr'</span>] <span class="op">=</span> average_fill(data_tmp[<span class="st">'hr'</span>])</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(data_tmp[<span class="st">'hr'</span>].isnull().<span class="bu">sum</span>())</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span> data_tmp[<span class="st">'hr'</span>].isnull().<span class="bu">sum</span>() <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data_tmp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pd.date_range(<span class="st">'2022-03-29 00:00'</span>, <span class="st">'2022-03-30 00:00'</span>, freq <span class="op">=</span> <span class="st">'T'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DatetimeIndex(['2022-03-29 00:00:00', '2022-03-29 00:01:00',
               '2022-03-29 00:02:00', '2022-03-29 00:03:00',
               '2022-03-29 00:04:00', '2022-03-29 00:05:00',
               '2022-03-29 00:06:00', '2022-03-29 00:07:00',
               '2022-03-29 00:08:00', '2022-03-29 00:09:00',
               ...
               '2022-03-29 23:51:00', '2022-03-29 23:52:00',
               '2022-03-29 23:53:00', '2022-03-29 23:54:00',
               '2022-03-29 23:55:00', '2022-03-29 23:56:00',
               '2022-03-29 23:57:00', '2022-03-29 23:58:00',
               '2022-03-29 23:59:00', '2022-03-30 00:00:00'],
              dtype='datetime64[ns]', length=1441, freq='T')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>garmin_0329_hr <span class="op">=</span> garmin_prep(garmin_hr, <span class="st">'2022-03-29 00:00'</span>, <span class="st">'2022-03-30 00:00'</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(garmin_0329_hr.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     heart_rate
2022-03-29 00:00:00        55.0
2022-03-29 00:01:00        55.0
2022-03-29 00:02:00        55.0
2022-03-29 00:03:00        55.0
2022-03-29 00:04:00        56.0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> garmin_vs_fitbit(fit, gar, gar_act <span class="op">=</span> <span class="va">False</span>):</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    gar_col <span class="op">=</span> <span class="st">'hr'</span> <span class="cf">if</span> gar_act <span class="cf">else</span> <span class="st">'heart_rate'</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    gar.plot(y <span class="op">=</span> gar_col, use_index<span class="op">=</span><span class="va">True</span>,  kind <span class="op">=</span> <span class="st">'line'</span>, <span class="op">\</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                    figsize <span class="op">=</span> (<span class="dv">12</span>,<span class="dv">12</span>), label <span class="op">=</span> <span class="st">'Garmin'</span>, grid <span class="op">=</span> <span class="va">True</span>, ylabel <span class="op">=</span> <span class="st">'Heart Rate'</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    fit[<span class="st">'bpm'</span>].plot(y <span class="op">=</span> <span class="st">'bpm'</span>, grid <span class="op">=</span> <span class="va">True</span>, kind <span class="op">=</span> <span class="st">'line'</span>, linewidth <span class="op">=</span> <span class="dv">1</span> <span class="op">\</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>                      ,  label <span class="op">=</span> <span class="st">'Fitbit'</span>, legend <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="first-visualization-of-heart-rate-data-between-garmin-and-fitbit" class="level2">
<h2 class="anchored" data-anchor-id="first-visualization-of-heart-rate-data-between-garmin-and-fitbit">First visualization of heart rate data between Garmin and Fitbit</h2>
<div class="cell" data-execution_count="151">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>garmin_vs_fitbit(df_fitbit, garmin_0329_hr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="HR_files/figure-html/cell-22-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>As seen in the plot above, Garmin has a tendency of overestimating hr (up to 20 bpm) when there are spikes. This result is consistent with my experiences in hand measuring my own hr. There is suggestion that Garmin’s hr algorithm is loosely tied with number of steps. Further data collection and investigation are required to check the claim.</p>
<div class="cell" data-execution_count="152">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">"figure.figsize"</span>] <span class="op">=</span> (<span class="dv">12</span>,<span class="dv">12</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(df_fitbit.index, y <span class="op">=</span> <span class="st">'bpm'</span>, s<span class="op">=</span><span class="dv">3</span>,  data <span class="op">=</span> df_fitbit )</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>plt.scatter(garmin_0329_hr.index, y <span class="op">=</span> <span class="st">'heart_rate'</span>, s<span class="op">=</span><span class="dv">5</span>,  data <span class="op">=</span> garmin_0329_hr )</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>plt.grid(linestyle<span class="op">=</span><span class="st">'-'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="HR_files/figure-html/cell-23-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="153">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df_fitbit[<span class="st">'bpm'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="153">
<pre><code>dateTime
2022-03-29 00:00:00    56
2022-03-29 00:01:00    58
2022-03-29 00:02:00    56
2022-03-29 00:03:00    56
2022-03-29 00:04:00    55
                       ..
2022-03-29 23:56:00    55
2022-03-29 23:57:00    57
2022-03-29 23:58:00    56
2022-03-29 23:59:00    56
2022-03-30 00:00:00    64
Name: bpm, Length: 1441, dtype: int64</code></pre>
</div>
</div>
<p>Now let’s investigate in the correlation between Fitbit and Garmin.</p>
<div class="cell" data-execution_count="154">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>corr_df <span class="op">=</span> df_fitbit.merge(garmin_0329_hr, left_index <span class="op">=</span> <span class="va">True</span>, right_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>corr_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="154">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>bpm</th>
      <th>confidence</th>
      <th>heart_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022-03-29 00:00:00</th>
      <td>56</td>
      <td>3</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>2022-03-29 00:01:00</th>
      <td>58</td>
      <td>3</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>2022-03-29 00:02:00</th>
      <td>56</td>
      <td>3</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>2022-03-29 00:03:00</th>
      <td>56</td>
      <td>3</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>2022-03-29 00:04:00</th>
      <td>55</td>
      <td>3</td>
      <td>56.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2022-03-29 23:56:00</th>
      <td>55</td>
      <td>3</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>2022-03-29 23:57:00</th>
      <td>57</td>
      <td>3</td>
      <td>56.0</td>
    </tr>
    <tr>
      <th>2022-03-29 23:58:00</th>
      <td>56</td>
      <td>3</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>2022-03-29 23:59:00</th>
      <td>56</td>
      <td>3</td>
      <td>56.0</td>
    </tr>
    <tr>
      <th>2022-03-30 00:00:00</th>
      <td>64</td>
      <td>3</td>
      <td>56.0</td>
    </tr>
  </tbody>
</table>
<p>1441 rows × 3 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="155">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> corr_plot(data, save <span class="op">=</span> <span class="va">False</span>):</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    plt.rcParams[<span class="st">"figure.figsize"</span>] <span class="op">=</span> (<span class="dv">8</span>,<span class="dv">8</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    plt.figure()</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    plt.scatter(corr_df[<span class="st">'bpm'</span>], corr_df[<span class="st">'heart_rate'</span>], s <span class="op">=</span> <span class="dv">5</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="bu">int</span>(<span class="bu">min</span>(<span class="bu">list</span>(data[<span class="st">'bpm'</span>]) <span class="op">+</span> <span class="bu">list</span>(data[<span class="st">'heart_rate'</span>]))), <span class="op">\</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                  <span class="bu">int</span>(<span class="bu">max</span>(<span class="bu">list</span>(data[<span class="st">'bpm'</span>]) <span class="op">+</span> <span class="bu">list</span>(data[<span class="st">'heart_rate'</span>])))))</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> x</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    plt.plot(x, y)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    tittle <span class="op">=</span> <span class="st">"Heart rate comparison between Garmin and Fitbit"</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    plt.title(tittle)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">"Fitbit hr"</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Garmin hr'</span>)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> save <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>        plt.savefig(<span class="ss">f"</span><span class="sc">{</span>tittle<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="156">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>corr_plot(corr_df, save <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="HR_files/figure-html/cell-27-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="157">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># joint_kws=dict(gridsize=20)</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.jointplot(data = corr_df[~corr_df.index.duplicated()] , x="bpm", \</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">#               y="heart_rate", kind = 'hex', joint_kws = joint_kws, palette = sns.dark_palette("seagreen", as_cmap=True))</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># x = list(range(int(min(list(corr_df['bpm']) + list(corr_df['heart_rate']))), \</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                   int(max(list(corr_df['bpm']) + list(corr_df['heart_rate'])))))</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># y = x</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.lineplot(x, y)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>corr_df[<span class="st">'bpm'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="158">
<pre><code>2022-03-29 00:00:00    56
2022-03-29 00:01:00    58
2022-03-29 00:02:00    56
2022-03-29 00:03:00    56
2022-03-29 00:04:00    55
                       ..
2022-03-29 23:56:00    55
2022-03-29 23:57:00    57
2022-03-29 23:58:00    56
2022-03-29 23:59:00    56
2022-03-30 00:00:00    64
Name: bpm, Length: 1441, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="159">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>corr_df.loc[corr_df.index.duplicated()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="159">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>bpm</th>
      <th>confidence</th>
      <th>heart_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022-03-29 04:17:00</th>
      <td>48</td>
      <td>3</td>
      <td>47.0</td>
    </tr>
    <tr>
      <th>2022-03-29 10:23:00</th>
      <td>99</td>
      <td>1</td>
      <td>107.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="160">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>corr_df.loc[<span class="st">'2022-03-29 04:17:00'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="160">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>bpm</th>
      <th>confidence</th>
      <th>heart_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022-03-29 04:17:00</th>
      <td>48</td>
      <td>3</td>
      <td>47.0</td>
    </tr>
    <tr>
      <th>2022-03-29 04:17:00</th>
      <td>48</td>
      <td>3</td>
      <td>47.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="161">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>act_dir <span class="op">=</span> <span class="st">'./Fitbit/ShiYangLee/Physical Activity/exercise-0.json'</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_columns'</span>, <span class="va">None</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>act_df <span class="op">=</span> pd.read_json(act_dir)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>act_df.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="161">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>logId</th>
      <th>activityName</th>
      <th>activityTypeId</th>
      <th>activityLevel</th>
      <th>averageHeartRate</th>
      <th>calories</th>
      <th>duration</th>
      <th>activeDuration</th>
      <th>steps</th>
      <th>source</th>
      <th>logType</th>
      <th>manualValuesSpecified</th>
      <th>heartRateZones</th>
      <th>lastModified</th>
      <th>startTime</th>
      <th>originalStartTime</th>
      <th>originalDuration</th>
      <th>hasGps</th>
      <th>shouldFetchDetails</th>
      <th>hasActiveZoneMinutes</th>
      <th>distance</th>
      <th>distanceUnit</th>
      <th>tcxLink</th>
      <th>speed</th>
      <th>pace</th>
      <th>elevationGain</th>
      <th>activeZoneMinutes</th>
      <th>vo2Max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>46265675913</td>
      <td>Fitstar: Personal Trainer</td>
      <td>3104</td>
      <td>[{'minutes': 0, 'name': 'sedentary'}, {'minute...</td>
      <td>95</td>
      <td>77</td>
      <td>1146000</td>
      <td>1146000</td>
      <td>159.0</td>
      <td>{'type': 'app', 'name': 'Fitbit for Android', ...</td>
      <td>manual</td>
      <td>{'calories': False, 'distance': True, 'steps':...</td>
      <td>[{'name': 'Out of Range', 'min': 30, 'max': 98...</td>
      <td>02/27/22 09:27:55</td>
      <td>02/27/22 09:08:19</td>
      <td>02/27/22 09:08:19</td>
      <td>1146000</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>46265383938</td>
      <td>Yoga</td>
      <td>52000</td>
      <td>[{'minutes': 0, 'name': 'sedentary'}, {'minute...</td>
      <td>100</td>
      <td>86</td>
      <td>1273000</td>
      <td>1273000</td>
      <td>32.0</td>
      <td>{'type': 'app', 'name': 'Fitbit for Android', ...</td>
      <td>manual</td>
      <td>{'calories': False, 'distance': True, 'steps':...</td>
      <td>[{'name': 'Out of Range', 'min': 30, 'max': 98...</td>
      <td>02/27/22 22:05:19</td>
      <td>02/27/22 21:43:36</td>
      <td>02/27/22 21:43:36</td>
      <td>1273000</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="162">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>act_df <span class="op">=</span> act_df[(act_df[<span class="st">'activityName'</span>] <span class="op">==</span> <span class="st">'Run'</span>) <span class="op">&amp;</span> (act_df[<span class="st">'originalStartTime'</span>] <span class="op">&gt;=</span> <span class="st">'03/23/22'</span>)]</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>longest_run_df <span class="op">=</span> act_df.loc[act_df[<span class="st">'distance'</span>].idxmax()]</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>longest_run_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="162">
<pre><code>logId                                                          46904851848
activityName                                                           Run
activityTypeId                                                       90009
activityLevel            [{'minutes': 0, 'name': 'sedentary'}, {'minute...
averageHeartRate                                                       130
calories                                                               144
duration                                                           1067000
activeDuration                                                     1036000
steps                                                               2329.0
source                   {'type': 'tracker', 'name': 'Charge 4', 'id': ...
logType                                                            tracker
manualValuesSpecified    {'calories': False, 'distance': False, 'steps'...
heartRateZones           [{'name': 'Out of Range', 'min': 30, 'max': 11...
lastModified                                             03/27/22 14:16:43
startTime                                                03/27/22 13:55:10
originalStartTime                                        03/27/22 13:55:10
originalDuration                                                   1067000
hasGps                                                                True
shouldFetchDetails                                                    True
hasActiveZoneMinutes                                                  True
distance                                                          2.537586
distanceUnit                                                     Kilometer
tcxLink                  https://www.fitbit.com/activities/exercise/469...
speed                                                              8.89985
pace                                                            404.501208
elevationGain                                                       17.374
activeZoneMinutes        {'totalMinutes': 18, 'minutesInHeartRateZones'...
vo2Max                                                {'vo2Max': 64.82186}
Name: 54, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="163">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> longest_run_df[<span class="st">'startTime'</span>]</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>end_time <span class="op">=</span> longest_run_df[<span class="st">'lastModified'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="164">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>fitbit_run_df <span class="op">=</span> pd.read_json(<span class="st">"./Fitbit/ShiYangLee/"</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"Physical Activity/heart_rate-2022-03-27.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="165">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>fitbit_run_df <span class="op">=</span> fitbit_run_df[(fitbit_run_df[<span class="st">'dateTime'</span>] <span class="op">&gt;=</span>start_time) <span class="op">&amp;</span> <span class="op">\</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                               (fitbit_run_df[<span class="st">'dateTime'</span>] <span class="op">&lt;=</span> end_time)]</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>data_split(fitbit_run_df)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>fitbit_run_df <span class="op">=</span> fitbit_dataprep(fitbit_run_df)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>fitbit_run_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="165">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>bpm</th>
      <th>confidence</th>
    </tr>
    <tr>
      <th>dateTime</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022-03-27 13:55:11</th>
      <td>78</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2022-03-27 13:55:14</th>
      <td>78</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2022-03-27 13:55:15</th>
      <td>70</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2022-03-27 13:55:18</th>
      <td>70</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2022-03-27 13:55:20</th>
      <td>78</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="166">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>garmin_act_dir <span class="op">=</span> <span class="st">'./Garmin_05042022/DI_CONNECT/DI-Connect-Fitness/shiyanglee1998@gmail.com_0_summarizedActivities.json'</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>garmin_act_df <span class="op">=</span> pd.read_json(garmin_act_dir)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>garmin_act_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="166">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>summarizedActivitiesExport</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[{'activityId': 8585417065, 'uuidMsb': 8769992...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="167">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>display(garmin_act_df[<span class="st">'summarizedActivitiesExport'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0    [{'activityId': 8585417065, 'uuidMsb': 8769992...
Name: summarizedActivitiesExport, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="168">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="bu">open</span>(garmin_act_dir)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>stud_obj <span class="op">=</span> json.load(f)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>garmin_act_df <span class="op">=</span> pd.json_normalize(stud_obj[<span class="dv">0</span>][<span class="st">'summarizedActivitiesExport'</span>])</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>display(garmin_act_df)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>garmin_act_df <span class="op">=</span> garmin_act_df[garmin_act_df[<span class="st">'activityType'</span>] <span class="op">==</span> <span class="st">'running'</span>]</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>garmin_act_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>activityId</th>
      <th>uuidMsb</th>
      <th>uuidLsb</th>
      <th>name</th>
      <th>activityType</th>
      <th>userProfileId</th>
      <th>timeZoneId</th>
      <th>beginTimestamp</th>
      <th>eventTypeId</th>
      <th>rule</th>
      <th>sportType</th>
      <th>startTimeGmt</th>
      <th>startTimeLocal</th>
      <th>duration</th>
      <th>distance</th>
      <th>avgSpeed</th>
      <th>avgHr</th>
      <th>maxHr</th>
      <th>calories</th>
      <th>bmrCalories</th>
      <th>avgFractionalCadence</th>
      <th>maxFractionalCadence</th>
      <th>elapsedDuration</th>
      <th>movingDuration</th>
      <th>deviceId</th>
      <th>summarizedExerciseSets</th>
      <th>avgVerticalSpeed</th>
      <th>manufacturer</th>
      <th>lapCount</th>
      <th>waterEstimated</th>
      <th>activeSets</th>
      <th>totalSets</th>
      <th>totalReps</th>
      <th>minRespirationRate</th>
      <th>maxRespirationRate</th>
      <th>avgRespirationRate</th>
      <th>startStress</th>
      <th>endStress</th>
      <th>differenceStress</th>
      <th>parent</th>
      <th>purposeful</th>
      <th>autoCalcCalories</th>
      <th>favorite</th>
      <th>pr</th>
      <th>elevationCorrected</th>
      <th>decoDive</th>
      <th>atpActivity</th>
      <th>maxSpeed</th>
      <th>maxRunCadence</th>
      <th>steps</th>
      <th>startLongitude</th>
      <th>startLatitude</th>
      <th>avgStrideLength</th>
      <th>avgDoubleCadence</th>
      <th>maxDoubleCadence</th>
      <th>locationName</th>
      <th>endLongitude</th>
      <th>endLatitude</th>
      <th>elevationGain</th>
      <th>minElevation</th>
      <th>maxElevation</th>
      <th>maxVerticalSpeed</th>
      <th>elevationLoss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8585417065</td>
      <td>8769992561222502513</td>
      <td>-5381239037487348160</td>
      <td>Yoga</td>
      <td>yoga</td>
      <td>103595922</td>
      <td>159</td>
      <td>1649168835000</td>
      <td>9</td>
      <td>private</td>
      <td>TRAINING</td>
      <td>1.649169e+12</td>
      <td>1.649172e+12</td>
      <td>1.380427e+06</td>
      <td>0.000000</td>
      <td>0.0000</td>
      <td>115.0</td>
      <td>138.0</td>
      <td>486.04232</td>
      <td>108.94052</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.389004e+06</td>
      <td>0.0</td>
      <td>3319523804</td>
      <td>[{'category': 'UNKNOWN', 'reps': 0, 'volume': ...</td>
      <td>0.0</td>
      <td>GARMIN</td>
      <td>1</td>
      <td>137.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>16.0</td>
      <td>13.0</td>
      <td>87.0</td>
      <td>82.0</td>
      <td>-5.0</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8547669753</td>
      <td>-585674442942689358</td>
      <td>-8269768808003405382</td>
      <td>Highlands Walking</td>
      <td>walking</td>
      <td>103595922</td>
      <td>159</td>
      <td>1648574171000</td>
      <td>9</td>
      <td>private</td>
      <td>STEPS</td>
      <td>1.648574e+12</td>
      <td>1.648578e+12</td>
      <td>3.939050e+05</td>
      <td>35129.000854</td>
      <td>0.0892</td>
      <td>114.0</td>
      <td>125.0</td>
      <td>150.84072</td>
      <td>29.33014</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.939050e+05</td>
      <td>301000.0</td>
      <td>3319523804</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>GARMIN</td>
      <td>1</td>
      <td>39.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0.1312</td>
      <td>59.0</td>
      <td>596.0</td>
      <td>-4.223679</td>
      <td>57.479507</td>
      <td>48.644402</td>
      <td>110.0</td>
      <td>118.0</td>
      <td>Highlands</td>
      <td>-4.223679</td>
      <td>57.479507</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8547387963</td>
      <td>-460097293658141230</td>
      <td>-6855219939043478596</td>
      <td>Highlands Walking</td>
      <td>walking</td>
      <td>103595922</td>
      <td>159</td>
      <td>1648571549000</td>
      <td>9</td>
      <td>private</td>
      <td>STEPS</td>
      <td>1.648572e+12</td>
      <td>1.648575e+12</td>
      <td>6.436700e+05</td>
      <td>104598.999023</td>
      <td>0.1625</td>
      <td>109.0</td>
      <td>131.0</td>
      <td>259.78124</td>
      <td>50.28024</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>6.436700e+05</td>
      <td>604000.0</td>
      <td>3319523804</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>GARMIN</td>
      <td>2</td>
      <td>64.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>0.1751</td>
      <td>85.0</td>
      <td>1248.0</td>
      <td>-4.236015</td>
      <td>57.481029</td>
      <td>81.648981</td>
      <td>120.0</td>
      <td>170.0</td>
      <td>Highlands</td>
      <td>-4.223692</td>
      <td>57.479492</td>
      <td>921.974373</td>
      <td>98.037750</td>
      <td>1356.273651</td>
      <td>0.020634</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8534876453</td>
      <td>143174783359534367</td>
      <td>-6614897849812160408</td>
      <td>Highlands Breathwork</td>
      <td>breathwork</td>
      <td>103595922</td>
      <td>159</td>
      <td>1648391441000</td>
      <td>9</td>
      <td>private</td>
      <td>TRAINING</td>
      <td>1.648391e+12</td>
      <td>1.648395e+12</td>
      <td>3.062180e+05</td>
      <td>0.000000</td>
      <td>0.0000</td>
      <td>104.0</td>
      <td>111.0</td>
      <td>121.51058</td>
      <td>20.95010</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.062180e+05</td>
      <td>0.0</td>
      <td>3319523804</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>GARMIN</td>
      <td>1</td>
      <td>30.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>14.0</td>
      <td>4.0</td>
      <td>88.0</td>
      <td>94.0</td>
      <td>6.0</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0.0000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-4.458025</td>
      <td>57.515163</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Highlands</td>
      <td>-4.458025</td>
      <td>57.515163</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8534680997</td>
      <td>5243033286344131808</td>
      <td>-5225280365562076529</td>
      <td>Highlands Running</td>
      <td>running</td>
      <td>103595922</td>
      <td>159</td>
      <td>1648389297000</td>
      <td>9</td>
      <td>private</td>
      <td>RUNNING</td>
      <td>1.648389e+12</td>
      <td>1.648393e+12</td>
      <td>1.064667e+06</td>
      <td>257898.999023</td>
      <td>0.2422</td>
      <td>148.0</td>
      <td>178.0</td>
      <td>779.34372</td>
      <td>83.80040</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.064667e+06</td>
      <td>1004000.0</td>
      <td>3319523804</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>GARMIN</td>
      <td>3</td>
      <td>106.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>0.3491</td>
      <td>86.0</td>
      <td>2370.0</td>
      <td>-4.457854</td>
      <td>57.515198</td>
      <td>100.382250</td>
      <td>146.0</td>
      <td>172.0</td>
      <td>Highlands</td>
      <td>-4.458025</td>
      <td>57.515167</td>
      <td>441.679764</td>
      <td>3300.000000</td>
      <td>4042.931366</td>
      <td>0.016471</td>
      <td>511.347198</td>
    </tr>
    <tr>
      <th>5</th>
      <td>8524148849</td>
      <td>-5281915893233795026</td>
      <td>-5423911554964189808</td>
      <td>Highlands Breathwork</td>
      <td>breathwork</td>
      <td>103595922</td>
      <td>159</td>
      <td>1648245617000</td>
      <td>9</td>
      <td>private</td>
      <td>TRAINING</td>
      <td>1.648246e+12</td>
      <td>1.648246e+12</td>
      <td>3.288570e+05</td>
      <td>0.000000</td>
      <td>0.0000</td>
      <td>69.0</td>
      <td>76.0</td>
      <td>33.52016</td>
      <td>25.14012</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.288570e+05</td>
      <td>0.0</td>
      <td>3319523804</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>GARMIN</td>
      <td>1</td>
      <td>32.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>13.0</td>
      <td>4.0</td>
      <td>37.0</td>
      <td>54.0</td>
      <td>17.0</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0.0000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-4.457852</td>
      <td>57.515160</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Highlands</td>
      <td>-4.457852</td>
      <td>57.515160</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8523132998</td>
      <td>-7226774362203664814</td>
      <td>-8147720748920905653</td>
      <td>Highlands Running</td>
      <td>running</td>
      <td>103595922</td>
      <td>159</td>
      <td>1648230247000</td>
      <td>9</td>
      <td>private</td>
      <td>RUNNING</td>
      <td>1.648230e+12</td>
      <td>1.648230e+12</td>
      <td>9.274030e+05</td>
      <td>200728.002930</td>
      <td>0.2164</td>
      <td>132.0</td>
      <td>157.0</td>
      <td>569.84272</td>
      <td>75.42036</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>9.274030e+05</td>
      <td>861000.0</td>
      <td>3319523804</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>GARMIN</td>
      <td>3</td>
      <td>92.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>0.3649</td>
      <td>88.0</td>
      <td>1934.0</td>
      <td>-4.457877</td>
      <td>57.515087</td>
      <td>92.692598</td>
      <td>140.0</td>
      <td>176.0</td>
      <td>Highlands</td>
      <td>-4.457845</td>
      <td>57.515163</td>
      <td>493.555641</td>
      <td>3000.000000</td>
      <td>3700.000000</td>
      <td>0.028839</td>
      <td>475.959206</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8516186695</td>
      <td>1362925181960931509</td>
      <td>-6160943228134636888</td>
      <td>Highlands Breathwork</td>
      <td>breathwork</td>
      <td>103595922</td>
      <td>159</td>
      <td>1648133045000</td>
      <td>9</td>
      <td>private</td>
      <td>TRAINING</td>
      <td>1.648133e+12</td>
      <td>1.648133e+12</td>
      <td>3.086410e+05</td>
      <td>0.000000</td>
      <td>0.0000</td>
      <td>77.0</td>
      <td>94.0</td>
      <td>41.90020</td>
      <td>20.95010</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.086410e+05</td>
      <td>0.0</td>
      <td>3319523804</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>GARMIN</td>
      <td>1</td>
      <td>30.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>15.0</td>
      <td>4.0</td>
      <td>39.0</td>
      <td>79.0</td>
      <td>40.0</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0.0000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-4.239242</td>
      <td>57.480835</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Highlands</td>
      <td>-4.239242</td>
      <td>57.480835</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8514711795</td>
      <td>-272532357588563598</td>
      <td>-5415946412436882267</td>
      <td>Highlands Walking</td>
      <td>walking</td>
      <td>103595922</td>
      <td>159</td>
      <td>1648114829000</td>
      <td>9</td>
      <td>private</td>
      <td>STEPS</td>
      <td>1.648115e+12</td>
      <td>1.648115e+12</td>
      <td>9.979850e+05</td>
      <td>146721.997070</td>
      <td>0.1470</td>
      <td>125.0</td>
      <td>136.0</td>
      <td>460.90220</td>
      <td>83.80040</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>9.979850e+05</td>
      <td>895000.0</td>
      <td>3319523804</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>GARMIN</td>
      <td>2</td>
      <td>99.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>0.2075</td>
      <td>65.0</td>
      <td>1832.0</td>
      <td>-4.221631</td>
      <td>57.479488</td>
      <td>72.304054</td>
      <td>122.0</td>
      <td>130.0</td>
      <td>Highlands</td>
      <td>-4.239240</td>
      <td>57.480835</td>
      <td>234.560871</td>
      <td>42.115098</td>
      <td>1408.461666</td>
      <td>0.019548</td>
      <td>905.342150</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="168">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>activityId</th>
      <th>uuidMsb</th>
      <th>uuidLsb</th>
      <th>name</th>
      <th>activityType</th>
      <th>userProfileId</th>
      <th>timeZoneId</th>
      <th>beginTimestamp</th>
      <th>eventTypeId</th>
      <th>rule</th>
      <th>sportType</th>
      <th>startTimeGmt</th>
      <th>startTimeLocal</th>
      <th>duration</th>
      <th>distance</th>
      <th>avgSpeed</th>
      <th>avgHr</th>
      <th>maxHr</th>
      <th>calories</th>
      <th>bmrCalories</th>
      <th>avgFractionalCadence</th>
      <th>maxFractionalCadence</th>
      <th>elapsedDuration</th>
      <th>movingDuration</th>
      <th>deviceId</th>
      <th>summarizedExerciseSets</th>
      <th>avgVerticalSpeed</th>
      <th>manufacturer</th>
      <th>lapCount</th>
      <th>waterEstimated</th>
      <th>activeSets</th>
      <th>totalSets</th>
      <th>totalReps</th>
      <th>minRespirationRate</th>
      <th>maxRespirationRate</th>
      <th>avgRespirationRate</th>
      <th>startStress</th>
      <th>endStress</th>
      <th>differenceStress</th>
      <th>parent</th>
      <th>purposeful</th>
      <th>autoCalcCalories</th>
      <th>favorite</th>
      <th>pr</th>
      <th>elevationCorrected</th>
      <th>decoDive</th>
      <th>atpActivity</th>
      <th>maxSpeed</th>
      <th>maxRunCadence</th>
      <th>steps</th>
      <th>startLongitude</th>
      <th>startLatitude</th>
      <th>avgStrideLength</th>
      <th>avgDoubleCadence</th>
      <th>maxDoubleCadence</th>
      <th>locationName</th>
      <th>endLongitude</th>
      <th>endLatitude</th>
      <th>elevationGain</th>
      <th>minElevation</th>
      <th>maxElevation</th>
      <th>maxVerticalSpeed</th>
      <th>elevationLoss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>8534680997</td>
      <td>5243033286344131808</td>
      <td>-5225280365562076529</td>
      <td>Highlands Running</td>
      <td>running</td>
      <td>103595922</td>
      <td>159</td>
      <td>1648389297000</td>
      <td>9</td>
      <td>private</td>
      <td>RUNNING</td>
      <td>1.648389e+12</td>
      <td>1.648393e+12</td>
      <td>1.064667e+06</td>
      <td>257898.999023</td>
      <td>0.2422</td>
      <td>148.0</td>
      <td>178.0</td>
      <td>779.34372</td>
      <td>83.80040</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.064667e+06</td>
      <td>1004000.0</td>
      <td>3319523804</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>GARMIN</td>
      <td>3</td>
      <td>106.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>0.3491</td>
      <td>86.0</td>
      <td>2370.0</td>
      <td>-4.457854</td>
      <td>57.515198</td>
      <td>100.382250</td>
      <td>146.0</td>
      <td>172.0</td>
      <td>Highlands</td>
      <td>-4.458025</td>
      <td>57.515167</td>
      <td>441.679764</td>
      <td>3300.0</td>
      <td>4042.931366</td>
      <td>0.016471</td>
      <td>511.347198</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8523132998</td>
      <td>-7226774362203664814</td>
      <td>-8147720748920905653</td>
      <td>Highlands Running</td>
      <td>running</td>
      <td>103595922</td>
      <td>159</td>
      <td>1648230247000</td>
      <td>9</td>
      <td>private</td>
      <td>RUNNING</td>
      <td>1.648230e+12</td>
      <td>1.648230e+12</td>
      <td>9.274030e+05</td>
      <td>200728.002930</td>
      <td>0.2164</td>
      <td>132.0</td>
      <td>157.0</td>
      <td>569.84272</td>
      <td>75.42036</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>9.274030e+05</td>
      <td>861000.0</td>
      <td>3319523804</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>GARMIN</td>
      <td>3</td>
      <td>92.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>0.3649</td>
      <td>88.0</td>
      <td>1934.0</td>
      <td>-4.457877</td>
      <td>57.515087</td>
      <td>92.692598</td>
      <td>140.0</td>
      <td>176.0</td>
      <td>Highlands</td>
      <td>-4.457845</td>
      <td>57.515163</td>
      <td>493.555641</td>
      <td>3000.0</td>
      <td>3700.000000</td>
      <td>0.028839</td>
      <td>475.959206</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="169">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pd.Timestamp(<span class="st">'2022-03-27 14:54:00'</span>) <span class="op">-</span> pd.to_timedelta(<span class="dv">1648389297000</span>, unit <span class="op">=</span> <span class="st">'ms'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1970-01-01 00:59:03</code></pre>
</div>
</div>
<div class="cell" data-execution_count="170">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>garmin_act_df[<span class="st">'start_time'</span>] <span class="op">=</span> pd.Timestamp(<span class="st">'1970-01-01 01:00:00'</span>) <span class="op">+</span> pd.to_timedelta(<span class="op">\</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                            garmin_act_df[<span class="st">'beginTimestamp'</span>], unit<span class="op">=</span><span class="st">'ms'</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>garmin_act_df[<span class="st">'end_time'</span>] <span class="op">=</span> (garmin_act_df[<span class="st">'start_time'</span>] <span class="op">+</span> pd.to_timedelta(<span class="op">\</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                            garmin_act_df[<span class="st">'duration'</span>], unit <span class="op">=</span> <span class="st">'ms'</span>)).dt.strftime(<span class="op">\</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S'</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>garmin_act_df[[<span class="st">'start_time'</span>, <span class="st">'end_time'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="170">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>start_time</th>
      <th>end_time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>2022-03-27 14:54:57</td>
      <td>2022-03-27 15:12:41</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2022-03-25 18:44:07</td>
      <td>2022-03-25 18:59:34</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="171">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>time <span class="op">=</span> [<span class="st">'start_time'</span>, <span class="st">'end_time'</span>]</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>start_time, end_time <span class="op">=</span> [garmin_act_df[garmin_act_df[<span class="st">'activityId'</span>] <span class="op">==</span> <span class="dv">8534680997</span>] <span class="op">\</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                        [x].values <span class="cf">for</span> x <span class="kw">in</span> time]</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(start_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['2022-03-27T14:54:57.000000000']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="172">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>[garmin_act_df[garmin_act_df[<span class="st">'activityId'</span>] <span class="op">==</span> <span class="dv">8534680997</span>] <span class="op">\</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>                        [x].values <span class="cf">for</span> x <span class="kw">in</span> time]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="172">
<pre><code>[array(['2022-03-27T14:54:57.000000000'], dtype='datetime64[ns]'),
 array(['2022-03-27 15:12:41'], dtype=object)]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="173">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>garmin_act_monit_db <span class="op">=</span> <span class="st">"./HealthData/DBs/garmin_activities.db"</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>garmin_act_monit_con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(garmin_act_monit_db)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>garmin_act_monit_df <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT name FROM sqlite_master"</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">" WHERE type = 'table'"</span>, garmin_act_monit_con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="174">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>garmin_act_monit_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="174">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>_attributes</td>
    </tr>
    <tr>
      <th>1</th>
      <td>activities</td>
    </tr>
    <tr>
      <th>2</th>
      <td>activities_devices</td>
    </tr>
    <tr>
      <th>3</th>
      <td>activity_laps</td>
    </tr>
    <tr>
      <th>4</th>
      <td>activity_records</td>
    </tr>
    <tr>
      <th>5</th>
      <td>steps_activities</td>
    </tr>
    <tr>
      <th>6</th>
      <td>paddle_activities</td>
    </tr>
    <tr>
      <th>7</th>
      <td>cycle_activities</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="175">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>garmin_act_rec <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * FROM activity_records"</span>, garmin_act_monit_con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="206">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>garmin_act_rec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="206">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>activity_id</th>
      <th>record</th>
      <th>timestamp</th>
      <th>position_lat</th>
      <th>position_long</th>
      <th>distance</th>
      <th>cadence</th>
      <th>hr</th>
      <th>rr</th>
      <th>altitude</th>
      <th>speed</th>
      <th>temperature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8534680997</td>
      <td>0</td>
      <td>2022-03-27 13:54:57.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.00000</td>
      <td>0.0</td>
      <td>92</td>
      <td>NaN</td>
      <td>None</td>
      <td>0.0000</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8534680997</td>
      <td>1</td>
      <td>2022-03-27 13:55:14.000000</td>
      <td>57.515198</td>
      <td>-4.457859</td>
      <td>0.00222</td>
      <td>0.0</td>
      <td>89</td>
      <td>NaN</td>
      <td>None</td>
      <td>0.0000</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8534680997</td>
      <td>2</td>
      <td>2022-03-27 13:55:26.000000</td>
      <td>57.515236</td>
      <td>-4.457681</td>
      <td>0.01761</td>
      <td>0.0</td>
      <td>86</td>
      <td>NaN</td>
      <td>None</td>
      <td>0.0000</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8534680997</td>
      <td>3</td>
      <td>2022-03-27 13:55:36.000000</td>
      <td>57.515316</td>
      <td>-4.457679</td>
      <td>0.02850</td>
      <td>0.0</td>
      <td>89</td>
      <td>NaN</td>
      <td>None</td>
      <td>3.2868</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8534680997</td>
      <td>4</td>
      <td>2022-03-27 13:55:37.000000</td>
      <td>57.515327</td>
      <td>-4.457682</td>
      <td>0.02978</td>
      <td>0.0</td>
      <td>86</td>
      <td>NaN</td>
      <td>None</td>
      <td>3.2904</td>
      <td>None</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7350</th>
      <td>8709534727</td>
      <td>174</td>
      <td>2022-04-26 13:33:24.000000</td>
      <td>57.479496</td>
      <td>-4.223857</td>
      <td>1.50551</td>
      <td>55.0</td>
      <td>125</td>
      <td>NaN</td>
      <td>None</td>
      <td>5.7924</td>
      <td>None</td>
    </tr>
    <tr>
      <th>7351</th>
      <td>8709534727</td>
      <td>175</td>
      <td>2022-04-26 13:33:26.000000</td>
      <td>57.479576</td>
      <td>-4.223705</td>
      <td>1.51946</td>
      <td>0.0</td>
      <td>129</td>
      <td>NaN</td>
      <td>None</td>
      <td>5.8104</td>
      <td>None</td>
    </tr>
    <tr>
      <th>7352</th>
      <td>8709534727</td>
      <td>176</td>
      <td>2022-04-26 13:33:30.000000</td>
      <td>57.479591</td>
      <td>-4.223726</td>
      <td>1.52277</td>
      <td>0.0</td>
      <td>129</td>
      <td>NaN</td>
      <td>None</td>
      <td>5.9112</td>
      <td>None</td>
    </tr>
    <tr>
      <th>7353</th>
      <td>8709534727</td>
      <td>177</td>
      <td>2022-04-26 13:33:31.000000</td>
      <td>57.479591</td>
      <td>-4.223738</td>
      <td>1.52348</td>
      <td>0.0</td>
      <td>130</td>
      <td>NaN</td>
      <td>None</td>
      <td>5.9112</td>
      <td>None</td>
    </tr>
    <tr>
      <th>7354</th>
      <td>8709534727</td>
      <td>178</td>
      <td>2022-04-26 13:33:35.000000</td>
      <td>57.479599</td>
      <td>-4.223732</td>
      <td>1.52440</td>
      <td>0.0</td>
      <td>130</td>
      <td>NaN</td>
      <td>None</td>
      <td>5.9148</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
<p>7355 rows × 12 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="205">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>garmin_act_rec.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="205">
<pre><code>Index(['activity_id', 'record', 'timestamp', 'position_lat', 'position_long',
       'distance', 'cadence', 'hr', 'rr', 'altitude', 'speed', 'temperature'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="177">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>garmin_run_df <span class="op">=</span> garmin_act_rec[garmin_act_rec[<span class="st">'activity_id'</span>] <span class="op">==</span> <span class="st">'8534680997'</span>]</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>garmin_run_df[<span class="st">'timestamp'</span>] <span class="op">=</span> pd.to_datetime(garmin_run_df[<span class="st">'timestamp'</span>], <span class="op">\</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                                            <span class="bu">format</span><span class="op">=</span><span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S.</span><span class="sc">%f</span><span class="st">'</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(garmin_run_df.timestamp.dtype)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>garmin_run_df[<span class="st">'timestamp'</span>] <span class="op">=</span> garmin_run_df[<span class="st">'timestamp'</span>] <span class="op">+</span> pd.Timedelta(<span class="dv">1</span>, <span class="st">'h'</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>garmin_run_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>datetime64[ns]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_16227/3239170002.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  garmin_run_df['timestamp'] = pd.to_datetime(garmin_run_df['timestamp'], \
/tmp/ipykernel_16227/3239170002.py:5: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  garmin_run_df['timestamp'] = garmin_run_df['timestamp'] + pd.Timedelta(1, 'h')</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="177">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>activity_id</th>
      <th>record</th>
      <th>timestamp</th>
      <th>position_lat</th>
      <th>position_long</th>
      <th>distance</th>
      <th>cadence</th>
      <th>hr</th>
      <th>rr</th>
      <th>altitude</th>
      <th>speed</th>
      <th>temperature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8534680997</td>
      <td>0</td>
      <td>2022-03-27 14:54:57</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.00000</td>
      <td>0.0</td>
      <td>92</td>
      <td>NaN</td>
      <td>None</td>
      <td>0.0000</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8534680997</td>
      <td>1</td>
      <td>2022-03-27 14:55:14</td>
      <td>57.515198</td>
      <td>-4.457859</td>
      <td>0.00222</td>
      <td>0.0</td>
      <td>89</td>
      <td>NaN</td>
      <td>None</td>
      <td>0.0000</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8534680997</td>
      <td>2</td>
      <td>2022-03-27 14:55:26</td>
      <td>57.515236</td>
      <td>-4.457681</td>
      <td>0.01761</td>
      <td>0.0</td>
      <td>86</td>
      <td>NaN</td>
      <td>None</td>
      <td>0.0000</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8534680997</td>
      <td>3</td>
      <td>2022-03-27 14:55:36</td>
      <td>57.515316</td>
      <td>-4.457679</td>
      <td>0.02850</td>
      <td>0.0</td>
      <td>89</td>
      <td>NaN</td>
      <td>None</td>
      <td>3.2868</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8534680997</td>
      <td>4</td>
      <td>2022-03-27 14:55:37</td>
      <td>57.515327</td>
      <td>-4.457682</td>
      <td>0.02978</td>
      <td>0.0</td>
      <td>86</td>
      <td>NaN</td>
      <td>None</td>
      <td>3.2904</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="178">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(garmin_prep.__doc__)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Function for garmin data preperation, setting timetamp as indices,
    converting datetime to format from years to seconds. Also fill null
    values with average filling method.
    </code></pre>
</div>
</div>
<div class="cell" data-execution_count="179">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>garmin_run_df <span class="op">=</span>  garmin_prep(garmin_run_df, reindex <span class="op">=</span> <span class="va">False</span>, data_type <span class="op">=</span> <span class="st">'act_monit'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="180">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>garmin_run_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="180">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>activity_id</th>
      <th>record</th>
      <th>position_lat</th>
      <th>position_long</th>
      <th>distance</th>
      <th>cadence</th>
      <th>hr</th>
      <th>rr</th>
      <th>altitude</th>
      <th>speed</th>
      <th>temperature</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022-03-27 14:54:57</th>
      <td>8534680997</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.00000</td>
      <td>0.0</td>
      <td>92.0</td>
      <td>NaN</td>
      <td>None</td>
      <td>0.0000</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2022-03-27 14:55:14</th>
      <td>8534680997</td>
      <td>1</td>
      <td>57.515198</td>
      <td>-4.457859</td>
      <td>0.00222</td>
      <td>0.0</td>
      <td>89.0</td>
      <td>NaN</td>
      <td>None</td>
      <td>0.0000</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2022-03-27 14:55:26</th>
      <td>8534680997</td>
      <td>2</td>
      <td>57.515236</td>
      <td>-4.457681</td>
      <td>0.01761</td>
      <td>0.0</td>
      <td>86.0</td>
      <td>NaN</td>
      <td>None</td>
      <td>0.0000</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2022-03-27 14:55:36</th>
      <td>8534680997</td>
      <td>3</td>
      <td>57.515316</td>
      <td>-4.457679</td>
      <td>0.02850</td>
      <td>0.0</td>
      <td>89.0</td>
      <td>NaN</td>
      <td>None</td>
      <td>3.2868</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2022-03-27 14:55:37</th>
      <td>8534680997</td>
      <td>4</td>
      <td>57.515327</td>
      <td>-4.457682</td>
      <td>0.02978</td>
      <td>0.0</td>
      <td>86.0</td>
      <td>NaN</td>
      <td>None</td>
      <td>3.2904</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="181">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>fit_run_dir <span class="op">=</span> <span class="st">"./Fitbit/ShiYangLee/Physical Activity/heart_rate-2022-03-27.json"</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>fit_run_raw <span class="op">=</span> pd.read_json(fit_run_dir)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>fit_run_raw.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="181">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>dateTime</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022-03-27 00:00:09</td>
      <td>{'bpm': 55, 'confidence': 3}</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2022-03-27 00:00:24</td>
      <td>{'bpm': 55, 'confidence': 3}</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2022-03-27 00:00:29</td>
      <td>{'bpm': 54, 'confidence': 3}</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2022-03-27 00:00:44</td>
      <td>{'bpm': 54, 'confidence': 3}</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2022-03-27 00:00:59</td>
      <td>{'bpm': 54, 'confidence': 3}</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="182">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>data_split(fit_run_raw)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>fit_run_df <span class="op">=</span> fitbit_dataprep(fit_run_raw)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>fit_run_df.index <span class="op">=</span> fit_run_df.index.shift(<span class="dv">1</span>, freq<span class="op">=</span><span class="st">'H'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="183">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>fit_run_df <span class="op">=</span> fit_run_df[(fit_run_df.index <span class="op">&gt;=</span> start_time[<span class="dv">0</span>]) <span class="op">&amp;</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>                        (fit_run_df.index <span class="op">&lt;=</span> end_time[<span class="dv">0</span>])]</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>fit_run_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="183">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>bpm</th>
      <th>confidence</th>
    </tr>
    <tr>
      <th>dateTime</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022-03-27 14:55:03</th>
      <td>78</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2022-03-27 14:55:11</th>
      <td>78</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2022-03-27 14:55:14</th>
      <td>78</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2022-03-27 14:55:15</th>
      <td>70</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2022-03-27 14:55:18</th>
      <td>70</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="184">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>garmin_vs_fitbit(fit_run_df, garmin_run_df, gar_act <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>garmin_run_df[<span class="st">'cadence'</span>].plot(label<span class="op">=</span><span class="st">'Cadence'</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="184">
<pre><code>&lt;matplotlib.legend.Legend at 0x7f55b8ed8df0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="HR_files/figure-html/cell-56-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="185">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> garmin_run_df[[<span class="st">'hr'</span>, <span class="st">'cadence'</span>]].merge(fit_run_df, left_index <span class="op">=</span> <span class="va">True</span>, <span class="op">\</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>                                              right_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>test.head()</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>test.to_csv(<span class="st">'test.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="186">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>126</code></pre>
</div>
</div>
<div class="cell" data-execution_count="187">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>test[[<span class="st">'hr'</span>, <span class="st">'bpm'</span>, <span class="st">'cadence'</span>]].plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="187">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="HR_files/figure-html/cell-59-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="188">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>test[<span class="st">'diff'</span>] <span class="op">=</span> <span class="bu">abs</span>(test[<span class="st">'bpm'</span>] <span class="op">-</span> test[<span class="st">'hr'</span>])</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>test[<span class="st">'cadence_diff'</span>] <span class="op">=</span> <span class="bu">abs</span>(test[<span class="st">'cadence'</span>] <span class="op">-</span>test[<span class="st">'cadence'</span>].shift(<span class="dv">1</span>))</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>test[<span class="st">'cadence_max_diff'</span>] <span class="op">=</span> <span class="bu">max</span>(test[<span class="st">'cadence'</span>]) <span class="op">-</span> test[<span class="st">'cadence'</span>]</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>test[<span class="st">'cadence_max_diff'</span>] <span class="op">=</span> test[<span class="st">'cadence_max_diff'</span>]</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>test[[<span class="st">'diff'</span>, <span class="st">'cadence_max_diff'</span>]].plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="188">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="HR_files/figure-html/cell-60-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="189">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>test[[<span class="st">'diff'</span>, <span class="st">'cadence'</span>]].plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="189">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="HR_files/figure-html/cell-61-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="190">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>garmin_run_df[[<span class="st">'hr'</span>, <span class="st">'cadence'</span>]].to_csv(<span class="st">'garmin_test.csv'</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>fit_run_df.to_csv(<span class="st">'fitbit.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="191">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> open_json(direct, table):</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>    con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(direct)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.read_sql_query(<span class="ss">f"SELECT * FROM </span><span class="sc">{</span>table<span class="sc">}</span><span class="ss">"</span>, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="192">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cadence_plot(idx, garmin, fitbit, inFunc <span class="op">=</span> <span class="va">True</span>, peak <span class="op">=</span> <span class="va">True</span>):</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    tmp <span class="op">=</span> open_json(<span class="st">'./HealthData/DBs/garmin_activities.db'</span>, <span class="st">'activities'</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    tmp <span class="op">=</span> tmp[tmp[<span class="st">'activity_id'</span>] <span class="op">==</span> idx]</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> pd.to_datetime(tmp[<span class="st">'start_time'</span>].values[<span class="dv">0</span>])</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    end <span class="op">=</span> pd.to_datetime(tmp[<span class="st">'stop_time'</span>].values[<span class="dv">0</span>])</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> attempt <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>):</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>        fitbit_tmp <span class="op">=</span> fitbit.copy()</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> start <span class="op">&gt;=</span> pd.to_datetime(<span class="st">'2022-03-27 01:00:00'</span>):</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>            start <span class="op">=</span> start <span class="op">+</span> pd.Timedelta(<span class="dv">1</span>, <span class="st">'h'</span>)</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>            end <span class="op">=</span> end <span class="op">+</span> pd.Timedelta(<span class="dv">1</span>, <span class="st">'h'</span>)</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>            fitbit_tmp.index <span class="op">=</span> fitbit.index.shift(<span class="dv">1</span>, freq<span class="op">=</span><span class="st">'H'</span>)</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>        fitbit_tmp <span class="op">=</span> fitbit_tmp[(fitbit_tmp.index <span class="op">&gt;=</span> start) <span class="op">&amp;</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>                        (fitbit_tmp.index <span class="op">&lt;=</span> end)]</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(fitbit_tmp) <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> attempt <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Fitbit data for activity "</span>, idx, <span class="st">"not found!"</span>)</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Trying to fetch data from Fitbit folder under Fitness folder directory..."</span>)</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>            <span class="co"># %run fitbit_generate_hr.ipynb</span></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>            fitbit <span class="op">=</span> pd.read_csv(<span class="st">'./Fitbit/ShiYangLee/Physical Activity/heart_rate_full.csv'</span>)</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>            fitbit <span class="op">=</span> fitbit_dataprep(fitbit)</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>            fitbit <span class="op">=</span> fitbit.sort_index()</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(fitbit_tmp) <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> attempt <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Fitbit data missing! Update Fitbit data manually by"</span></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>                  <span class="st">" replacing data export under Fitness directory and "</span></span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"generate complete hr data by running fitbit_generate_hr.ipynb"</span>)</span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>()</span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a>    fitbit_tmp <span class="op">=</span> fitbit_tmp.resample(<span class="st">'5s'</span>).mean()</span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a>    fitbit_tmp <span class="op">=</span> fitbit_tmp.interpolate()</span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a>    garmin_tmp <span class="op">=</span> garmin[garmin[<span class="st">'activity_id'</span>] <span class="op">==</span> idx]</span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a>    garmin_tmp <span class="op">=</span> garmin_tmp.set_index(<span class="st">'timestamp'</span>)</span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a>    garmin_tmp.index <span class="op">=</span> pd.to_datetime(garmin_tmp.index)</span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a>    garmin_tmp.index <span class="op">=</span> garmin_tmp.index.<span class="bu">map</span>(<span class="kw">lambda</span> x : x <span class="op">+</span> pd.Timedelta(<span class="dv">1</span>, <span class="st">'h'</span>) <span class="op">\</span></span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a>                                              <span class="cf">if</span> x <span class="op">&gt;=</span> pd.to_datetime(<span class="st">'2022-03-27 01:00:00'</span>) <span class="op">\</span></span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a>                                              <span class="cf">else</span> x)</span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a>    garmin_tmp <span class="op">=</span> garmin_tmp[[<span class="st">'hr'</span>, <span class="st">'cadence'</span>]]</span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a>    garmin_tmp <span class="op">=</span> garmin_tmp.resample(<span class="st">'5s'</span>).mean()</span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true" tabindex="-1"></a>    garmin_tmp[<span class="st">'cadence_diff'</span>] <span class="op">=</span> <span class="bu">abs</span>(garmin_tmp[<span class="st">'cadence'</span>] <span class="op">-</span> garmin_tmp[<span class="st">'cadence'</span>].shift(<span class="dv">1</span>))</span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true" tabindex="-1"></a>    garmin_tmp[<span class="st">'cadence_max_diff'</span>] <span class="op">=</span> <span class="bu">max</span>(garmin_tmp[<span class="st">'cadence'</span>]) <span class="op">-</span> garmin_tmp[<span class="st">'cadence'</span>]</span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true" tabindex="-1"></a>    garmin_tmp <span class="op">=</span> garmin_tmp.interpolate()</span>
<span id="cb89-42"><a href="#cb89-42" aria-hidden="true" tabindex="-1"></a>    merged_df <span class="op">=</span> garmin_tmp.merge(fitbit_tmp, left_index <span class="op">=</span> <span class="va">True</span>, <span class="op">\</span></span>
<span id="cb89-43"><a href="#cb89-43" aria-hidden="true" tabindex="-1"></a>                                              right_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb89-44"><a href="#cb89-44" aria-hidden="true" tabindex="-1"></a>    merged_df[<span class="st">'diff'</span>] <span class="op">=</span> <span class="bu">abs</span>(merged_df[<span class="st">'bpm'</span>] <span class="op">-</span> merged_df[<span class="st">'hr'</span>])</span>
<span id="cb89-45"><a href="#cb89-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># merged_df['cadence_diff'] = abs(merged_df['cadence'] -merged_df['cadence'].shift(1))</span></span>
<span id="cb89-46"><a href="#cb89-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># merged_df['cadence_max_diff'] = max(merged_df['cadence']) - merged_df['cadence']</span></span>
<span id="cb89-47"><a href="#cb89-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># merged_df['cadence_max_diff'] = merged_df['cadence_max_diff']</span></span>
<span id="cb89-48"><a href="#cb89-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> inFunc <span class="op">==</span> <span class="va">False</span>:</span>
<span id="cb89-49"><a href="#cb89-49" aria-hidden="true" tabindex="-1"></a>        fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb89-50"><a href="#cb89-50" aria-hidden="true" tabindex="-1"></a>        axs[<span class="dv">0</span>].plot(merged_df[[<span class="st">'hr'</span>, <span class="st">'bpm'</span>, <span class="st">'cadence'</span>]])</span>
<span id="cb89-51"><a href="#cb89-51" aria-hidden="true" tabindex="-1"></a>        axs[<span class="dv">1</span>].plot(merged_df[[<span class="st">'diff'</span>, <span class="st">'cadence_max_diff'</span>]])</span>
<span id="cb89-52"><a href="#cb89-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> peak <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb89-53"><a href="#cb89-53" aria-hidden="true" tabindex="-1"></a>            <span class="kw">def</span> to_date(value):</span>
<span id="cb89-54"><a href="#cb89-54" aria-hidden="true" tabindex="-1"></a>                _start <span class="op">=</span> merged_df.index[<span class="dv">0</span>]</span>
<span id="cb89-55"><a href="#cb89-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> pd.to_datetime(_start) <span class="op">+</span> pd.to_timedelta(<span class="dv">5</span><span class="op">*</span>value, <span class="st">'s'</span>)</span>
<span id="cb89-56"><a href="#cb89-56" aria-hidden="true" tabindex="-1"></a>            peaks, properties <span class="op">=</span> signal.find_peaks(merged_df[<span class="st">'diff'</span>], height<span class="op">=</span><span class="dv">20</span>,<span class="op">\</span></span>
<span id="cb89-57"><a href="#cb89-57" aria-hidden="true" tabindex="-1"></a>                                                  width <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb89-58"><a href="#cb89-58" aria-hidden="true" tabindex="-1"></a>            axs[<span class="dv">1</span>].plot(merged_df[<span class="st">'diff'</span>].iloc[peaks], <span class="st">"x"</span>)</span>
<span id="cb89-59"><a href="#cb89-59" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peaks)):</span>
<span id="cb89-60"><a href="#cb89-60" aria-hidden="true" tabindex="-1"></a>                cmap <span class="op">=</span> plt.cm.Reds</span>
<span id="cb89-61"><a href="#cb89-61" aria-hidden="true" tabindex="-1"></a>                norm <span class="op">=</span> matplotlib.colors.Normalize(vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="bu">len</span>(peaks)<span class="op">+</span><span class="dv">5</span>)</span>
<span id="cb89-62"><a href="#cb89-62" aria-hidden="true" tabindex="-1"></a>                axs[<span class="dv">1</span>].axvspan(date2num(to_date(properties[<span class="st">'left_ips'</span>][i])),<span class="op">\</span></span>
<span id="cb89-63"><a href="#cb89-63" aria-hidden="true" tabindex="-1"></a>                           date2num(to_date(properties[<span class="st">'right_ips'</span>][i])), <span class="op">\</span></span>
<span id="cb89-64"><a href="#cb89-64" aria-hidden="true" tabindex="-1"></a>                              color <span class="op">=</span> <span class="st">'yellow'</span>)</span>
<span id="cb89-65"><a href="#cb89-65" aria-hidden="true" tabindex="-1"></a>                               <span class="co"># ymin=0, ymax = 80)</span></span>
<span id="cb89-66"><a href="#cb89-66" aria-hidden="true" tabindex="-1"></a>                           <span class="co"># ymin=peaks[i]-properties['prominences'][i], \</span></span>
<span id="cb89-67"><a href="#cb89-67" aria-hidden="true" tabindex="-1"></a>                           <span class="co"># ymax=merged_df['diff'].iloc[peaks[i]])</span></span>
<span id="cb89-68"><a href="#cb89-68" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb89-69"><a href="#cb89-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> merged_df   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="193">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>fit_raw_df <span class="op">=</span> pd.read_csv(<span class="st">'./Fitbit/ShiYangLee/Physical Activity/heart_rate_full.csv'</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>fit_raw_df <span class="op">=</span> fitbit_dataprep(fit_raw_df)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>fit_raw_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="193">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>bpm</th>
      <th>confidence</th>
    </tr>
    <tr>
      <th>dateTime</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022-02-26 22:11:46</th>
      <td>73</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2022-02-26 22:11:51</th>
      <td>76</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2022-02-26 22:11:56</th>
      <td>76</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2022-02-26 22:12:06</th>
      <td>75</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2022-02-26 22:12:21</th>
      <td>74</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="194">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>fit_raw_df.index <span class="op">=</span> pd.to_datetime(fit_raw_df.index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="195">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> all_cadence_plot(activity <span class="op">=</span> <span class="st">'running'</span>, save <span class="op">=</span> <span class="va">False</span>, peak <span class="op">=</span> <span class="va">True</span>, <span class="op">**</span>kwargs):</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> garmin_get_running_id():</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>        garmin_act <span class="op">=</span> open_json(<span class="st">'./HealthData/DBs/garmin_activities.db'</span>, <span class="st">'activities'</span>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>        garmin_act <span class="op">=</span> garmin_act[garmin_act[<span class="st">'sport'</span>] <span class="op">==</span> activity]</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> garmin_act[<span class="st">'activity_id'</span>].to_list()</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    run_ids <span class="op">=</span> garmin_get_running_id()</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(run_ids)):</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>            df <span class="op">=</span> cadence_plot(run_ids[i], garmin_act_rec, fit_raw_df)</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>        fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="op">**</span>kwargs)</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>        axs[<span class="dv">0</span>].plot(df[[<span class="st">'hr'</span>, <span class="st">'bpm'</span>, <span class="st">'cadence'</span>]], <span class="op">\</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>                       label<span class="op">=</span>[<span class="st">'Garmin_hr'</span>, <span class="st">'Fitbit_hr'</span>, <span class="st">'Cadence'</span>])</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>        axs[<span class="dv">0</span>].legend()</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>        axs[<span class="dv">1</span>].plot(df[[<span class="st">'diff'</span>, <span class="st">'cadence_max_diff'</span>]], <span class="op">\</span></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>                      label<span class="op">=</span>[<span class="st">'hr_difference'</span>, <span class="st">'cadence_drop'</span>])</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> peak <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>            <span class="kw">def</span> to_date(value):</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>                _start <span class="op">=</span> df.index[<span class="dv">0</span>]</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> pd.to_datetime(_start) <span class="op">+</span> pd.to_timedelta(<span class="dv">5</span><span class="op">*</span>value, <span class="st">'s'</span>)</span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a>            peaks, properties <span class="op">=</span> signal.find_peaks(df[<span class="st">'diff'</span>], height<span class="op">=</span><span class="dv">20</span>,<span class="op">\</span></span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a>                                                  width <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a>            axs[<span class="dv">1</span>].plot(df[<span class="st">'diff'</span>].iloc[peaks], <span class="st">"x"</span>)</span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peaks)):</span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a>                cmap <span class="op">=</span> plt.cm.Reds</span>
<span id="cb92-27"><a href="#cb92-27" aria-hidden="true" tabindex="-1"></a>                norm <span class="op">=</span> matplotlib.colors.Normalize(vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="bu">len</span>(peaks)<span class="op">+</span><span class="dv">5</span>)</span>
<span id="cb92-28"><a href="#cb92-28" aria-hidden="true" tabindex="-1"></a>                axs[<span class="dv">1</span>].axvspan(date2num(to_date(properties[<span class="st">'left_ips'</span>][j])),<span class="op">\</span></span>
<span id="cb92-29"><a href="#cb92-29" aria-hidden="true" tabindex="-1"></a>                           date2num(to_date(properties[<span class="st">'right_ips'</span>][j])), <span class="op">\</span></span>
<span id="cb92-30"><a href="#cb92-30" aria-hidden="true" tabindex="-1"></a>                              color <span class="op">=</span> <span class="st">'yellow'</span>)</span>
<span id="cb92-31"><a href="#cb92-31" aria-hidden="true" tabindex="-1"></a>        axs[<span class="dv">1</span>].legend()</span>
<span id="cb92-32"><a href="#cb92-32" aria-hidden="true" tabindex="-1"></a>    fig.supxlabel(<span class="st">'Date Time'</span>)</span>
<span id="cb92-33"><a href="#cb92-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> save <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb92-34"><a href="#cb92-34" aria-hidden="true" tabindex="-1"></a>        plt.savefig(<span class="ss">f"</span><span class="sc">{</span>activity<span class="sc">}</span><span class="ss">_cadence_plot.png"</span>)</span>
<span id="cb92-35"><a href="#cb92-35" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="196">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>all_cadence_plot(figsize <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitbit data for activity  8740864771 not found!
Trying to fetch data from Fitbit folder under Fitness folder directory...
Fitbit data missing! Update Fitbit data manually by replacing data export under Fitness directory and generate complete hr data by running fitbit_generate_hr.ipynb</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="HR_files/figure-html/cell-68-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="HR_files/figure-html/cell-68-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="HR_files/figure-html/cell-68-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="HR_files/figure-html/cell-68-output-5.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="HR_files/figure-html/cell-68-output-6.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="HR_files/figure-html/cell-68-output-7.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="HR_files/figure-html/cell-68-output-8.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="197">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>test_run <span class="op">=</span> cadence_plot(<span class="st">'8740864771'</span>, garmin_act_rec, fit_raw_df, inFunc <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitbit data for activity  8740864771 not found!
Trying to fetch data from Fitbit folder under Fitness folder directory...
Fitbit data missing! Update Fitbit data manually by replacing data export under Fitness directory and generate complete hr data by running fitbit_generate_hr.ipynb</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>ValueError: </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>test_run.index[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>cadence_plot(<span class="st">'8523132998'</span>, garmin_act_rec, fit_raw_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>cadence_plot(<span class="st">'8693043387'</span>, garmin_act_rec, fit_raw_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> open_json(<span class="st">'./HealthData/DBs/garmin_activities.db'</span>, <span class="st">'activities'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> test[test[<span class="st">'sport'</span>] <span class="op">==</span> <span class="st">'running'</span>]</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dir_list = glob.glob('./Fitbit/ShiYangLee/Physical Activity/heart_rate-*.json')</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dfs = []</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for file in dir_list:</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     data = pd.read_json(file)</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     dfs.append(data)</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="co"># temp = pd.concat(dfs, ignore_index=True)</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="co"># temp</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="co"># data_split(temp)</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="co"># fitbit_raw_df = fitbit_dataprep(temp)</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a><span class="co"># fitbit_raw_df = fitbit_raw_df.sort_index()</span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="co"># fitbit_raw_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>test_run</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>test_run <span class="op">=</span> cadence_plot(<span class="st">'8534680997'</span>, garmin_act_rec, fit_raw_df, peak <span class="op">=</span> <span class="va">True</span>, inFunc <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>all_cadence_plot(activity <span class="op">=</span> <span class="st">'walking'</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">30</span>), save<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>):</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="dv">1</span><span class="op">/</span>i)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(i, <span class="st">"HIT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>